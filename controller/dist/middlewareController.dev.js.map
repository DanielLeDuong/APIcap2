{"version":3,"sources":["middlewareController.js"],"names":["jwt","require","middlewareController","verifyToken","req","res","next","token","headers","accessToken","split","verify","err","user","status","json","deleteAuth","id","params","role","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,oBAAoB,GAAG;AACzB;AACAC,EAAAA,WAAW,EAAE,qBAACC,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAkB;AAC3B,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAYD,KAA1B;;AACA,QAAGA,KAAH,EAAS;AACL,UAAME,WAAW,GAAGF,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAApB;AACAV,MAAAA,GAAG,CAACW,MAAJ,CAAWF,WAAX,EAAwB,WAAxB,EAAoC,UAACG,GAAD,EAAMC,IAAN,EAAe;AAC/C,YAAGD,GAAH,EAAO;AACHP,UAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,oBAArB;AACH;;AACDX,QAAAA,GAAG,CAACS,IAAJ,GAAWA,IAAX;AACAP,QAAAA,IAAI;AACP,OAND;AAOH,KATD,MAUK;AACDD,MAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,4BAArB;AACH;AAEJ,GAlBwB;AAoBzB;AACAC,EAAAA,UAAU,EAAE,oBAACZ,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAkB;AAC1BJ,IAAAA,oBAAoB,CAACC,WAArB,CAAiCC,GAAjC,EAAqCC,GAArC,EAA0C,YAAM;AAC5C,UAAGD,GAAG,CAACS,IAAJ,CAASI,EAAT,IAAeb,GAAG,CAACc,MAAJ,CAAWD,EAA1B,IAAgCb,GAAG,CAACS,IAAJ,CAASM,IAA5C,EAAkD;AAC9Cb,QAAAA,IAAI;AACP,OAFD,MAEO;AACHD,QAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,qCAArB;AACH;AACJ,KAND;AAOH;AA7BwB,CAA7B;AAgCAK,MAAM,CAACC,OAAP,GAAiBnB,oBAAjB","sourcesContent":["const jwt = require('jsonwebtoken')\r\n\r\nconst middlewareController = {\r\n    //verify token\r\n    verifyToken: (req,res,next) => {\r\n        const token = req.headers.token\r\n        if(token){\r\n            const accessToken = token.split(\" \")[1]\r\n            jwt.verify(accessToken, \"accessKey\",(err, user) => {\r\n                if(err){\r\n                    res.status(403).json(\"Token is not valid\")\r\n                }\r\n                req.user = user\r\n                next()\r\n            })\r\n        }\r\n        else {\r\n            res.status(401).json(\"You 're not authentication\")\r\n        }\r\n\r\n    },\r\n\r\n    //phan quyen xoa tai khoan\r\n    deleteAuth: (req,res,next) => {\r\n        middlewareController.verifyToken(req,res, () => {\r\n            if(req.user.id == req.params.id || req.user.role) {\r\n                next()\r\n            } else {\r\n                res.status(403).json(\"You are not allow to delete account\")\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nmodule.exports = middlewareController"],"file":"middlewareController.dev.js"}