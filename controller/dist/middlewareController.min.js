"use strict";var jwt=require("jsonwebtoken"),middlewareController={verifyToken:function(o,r,n){var e=o.headers.token;if(e){var t=e.split(" ")[1];jwt.verify(t,"accessKey",function(e,t){e&&r.status(403).json("Token is not valid"),o.user=t,n()})}else r.status(401).json("You 're not authentication")},deleteAuth:function(e,t,o){middlewareController.verifyToken(e,t,function(){e.user.id==e.params.id||e.user.role?o():t.status(403).json("You are not allow to delete account")})}};module.exports=middlewareController;
//# sourceMappingURL=middlewareController.min.js.map
